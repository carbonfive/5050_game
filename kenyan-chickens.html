<!DOCTYPE html>
<html>
<head>
	<style>
		#game{ border: 1px solid black; display: block; margin: auto;}
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
	<script>
		var chickenImg;
		var canvas;
		var context;
		var chickens = [];
		var hutImg;
		var hutX = 640*Math.random();
		var hutY = 480*Math.random();
		var animateId;
		
		var chicken = function() {
			var x = 640*Math.random();
			var y = 480*Math.random();
			var dragging = false;
			
			return {
				draw: function () {
					context.drawImage(chickenImg, x, y);
				},
				move: function () {
					if (!dragging) {
						x += 2*Math.random() - 1;
						y += 2*Math.random() - 1;
					}
				},
				startDrag: function(xClick, yClick) {
					var xOffset = xClick - x;
					var yOffset = yClick - y;
					dragging = true;
					canvas.onmousemove = function(e) {
						x = e.x - canvas.offsetLeft - xOffset;
						y = e.y - canvas.offsetTop - yOffset;
					}
				},
				endDrag: function() {
					canvas.onmousemove = null;
					dragging = false;
				},
				distanceFrom: function(x2, y2) {
					return Math.sqrt(Math.pow(x + 24 - x2, 2) + Math.pow(y + 28 - y2, 2));
				}
			}
		};
		
		window.onload = function() {
			chickenImg = document.getElementById('chicken');
			hutImg = document.getElementById('hut');
			canvas = document.getElementById("game");  
			if (canvas.getContext) {  
	        	context = canvas.getContext("2d");
				chickens.push(chicken());
				chickens.push(chicken());
				chickens.push(chicken());
				
				animateId = setInterval(function() {
					context.clearRect(0,0,640,480);
					context.drawImage(hutImg, hutX, hutY);
					$.each(chickens, function (i) {
						chickens[i].draw();
						chickens[i].move();
					});
				}, 25);
				
				canvas.onmousedown = function(e) {
					var x = e.x - canvas.offsetLeft;
					var y = e.y - canvas.offsetTop;
					
					$.each(chickens, function(i) {
						var distance = chickens[i].distanceFrom(x, y);
						if (distance < 25) {
							chickens[i].startDrag(x, y);
						}
					});
				}
				
				canvas.onmouseup = function () {
					$.each(chickens, function(i) { chickens[i].endDrag(); });
				}
			}
		};
		
		function stop() {
			clearInterval(animateId);
		}
		
		setTimeout(stop, 10000);
	</script>
</head>
<body>
	<img style="display: none;" id="chicken" src="chicken.png">
	<img style="display: none;" id="hut" src="hut.png">
	<canvas id="game" width="640" height="480">
		This game requires a browser that supports the HTML5 canvas element.
	</canvas>
	
</body>
</html>